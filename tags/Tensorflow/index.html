<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="robots" content="noindex"><meta><title>标签: Tensorflow - Hexo</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Hexo"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Hexo"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="Hexo"><meta property="og:url" content="http://example.com/"><meta property="og:site_name" content="Hexo"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://example.com/img/og_image.png"><meta property="article:author" content="John Doe"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com"},"headline":"Hexo","image":["http://example.com/img/og_image.png"],"author":{"@type":"Person","name":"John Doe"},"publisher":{"@type":"Organization","name":"Hexo","logo":{"@type":"ImageObject","url":"http://example.com/img/logo.svg"}},"description":""}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 6.1.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Hexo" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/tags">标签</a></li><li class="is-active"><a href="#" aria-current="page">Tensorflow</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-02-22T16:00:00.000Z" title="2/23/2020, 12:00:00 AM">2020-02-23</time>发表</span><span class="level-item"><time dateTime="2020-03-09T17:43:20.000Z" title="3/10/2020, 1:43:20 AM">2020-03-10</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%9C%AF%E4%B8%9A/">术业</a></span><span class="level-item">32 分钟读完 (大约4817个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/02/23/Major/01.Tensorflow_Udacity/">Tensorflow入门_Udacity</a></h1><div class="content"><h2 id="Cha1：-Hello-World"><a href="#Cha1：-Hello-World" class="headerlink" title="Cha1： Hello World"></a>Cha1： Hello World</h2><h3 id="基本术语"><a href="#基本术语" class="headerlink" title="基本术语"></a>基本术语</h3><ul>
<li><strong>人工智能：</strong>一种计算机科学分支，旨在让计算机达到人类的智慧。实现这一目标有很多方式，包括机器学习和深度学习。</li>
<li><strong>机器学习：</strong>一系列相关技术，用于训练计算机执行特定的任务。</li>
<li><strong>神经网络：</strong>一种机器学习结构，灵感来自人类大脑的神经元网络。神经网络是深度学习的基本概念。</li>
<li><strong>深度学习：</strong>机器学习的一个分支，利用多层神经网络实现目标。通常“机器学习”和“深度学习”可以相互指代。</li>
</ul>
<p><img src="https://video.udacity-data.com/topher/2019/March/5c7f0a2e_tensorflow-l1f1/tensorflow-l1f1.png" alt="基本术语的逻辑关系"></p>
<h3 id="机器学习算法应用"><a href="#机器学习算法应用" class="headerlink" title="机器学习算法应用"></a>机器学习算法应用</h3><ul>
<li>游戏： AlphaGo- Google DeepMind团队</li>
<li>医疗： 采用机器学习算法检测皮肤癌等，精度与人类专家相当</li>
<li>自动驾驶：</li>
<li>…</li>
</ul>
<h3 id="Tensorflow"><a href="#Tensorflow" class="headerlink" title="Tensorflow"></a>Tensorflow</h3><ul>
<li><strong>Tensorflow Lite:</strong> 可以在Android和iOS设备上创建移动应用</li>
<li><strong>Tensorflow.js:</strong> 可以在网络浏览器中运行相应的应用</li>
<li><strong>Tensorflow实现语言：</strong> Python, JavaScript, Swift, R, Julia等。但目前，Python和JavaScript是最完整的实现语言。</li>
<li><strong>Tensorflow开发环境：</strong> 本课程采用python和Google的开发环境Colab(类似于Jupyter Notebook，Colab采用交互式Notebook进行Python开发，程序在Google Cloud上托管，因此不需要配置软件环境，仅需在网络浏览器上使用)</li>
</ul>
<h3 id="练习：Python和Colab初级知识"><a href="#练习：Python和Colab初级知识" class="headerlink" title="练习：Python和Colab初级知识"></a>练习：Python和Colab初级知识</h3><ul>
<li><strong>个人练习:</strong> <a target="_blank" rel="noopener" href="https://github.com/AndreLYL/Tensorflow-learning/blob/master/Tensorflow_Udacity_tutorial_01.ipynb">https://github.com/AndreLYL/Tensorflow-learning/blob/master/Tensorflow_Udacity_tutorial_01.ipynb</a></li>
</ul>
<h2 id="Cha2：-机器学习简介"><a href="#Cha2：-机器学习简介" class="headerlink" title="Cha2： 机器学习简介"></a>Cha2： 机器学习简介</h2><h3 id="Sebastian访谈"><a href="#Sebastian访谈" class="headerlink" title="Sebastian访谈"></a>Sebastian访谈</h3><p>大佬告诉我们机器学习比计算机编程要简单，所以我们要相信大佬，大胆的去做吧，奥利给！</p>
<h3 id="传统算法和机器学习算法区别"><a href="#传统算法和机器学习算法区别" class="headerlink" title="传统算法和机器学习算法区别"></a>传统算法和机器学习算法区别</h3><p><img src="http://ww1.sinaimg.cn/large/006E0Yd9gy1gc6t1xkhpij30mx0a3wha.jpg" alt="传统算法和机器学习算法区别"></p>
<h3 id="机器学习术语"><a href="#机器学习术语" class="headerlink" title="机器学习术语"></a>机器学习术语</h3><ul>
<li><strong>特征</strong>：模型的输入</li>
<li><strong>样本</strong>：用于训练流程的输入&#x2F;输出对</li>
<li><strong>标签</strong>：模型的输出</li>
<li><strong>层级</strong>：神经网络中相互连接的节点集合。</li>
<li><strong>模型</strong>：神经网络的表示法</li>
<li>**密集全连接层 (FC)**：一个层级中的每个节点都与上个层级中的每个节点相连。</li>
<li><strong>权重和偏差</strong>：模型的内部变量</li>
<li><strong>损失</strong>：期望输出和真实输出之间的差值</li>
<li><strong>MSE</strong>：均方误差，一种损失函数，它会将一小部分很大的差值视作比大量很小的差值更糟糕。</li>
<li><strong>梯度下降法</strong>：每次小幅调整内部变量，从而逐渐降低损失函数的算法。</li>
<li><strong>优化器</strong>：梯度下降法的一种具体实现方法。（有很多算法。在这门课程中，我们将仅使用“Adam”优化器，它是 ADAptive with Momentum 的简称，并且被视为最佳优化器。）</li>
<li><strong>学习速率</strong>：梯度下降过程中的损失改进“步长”。</li>
<li><strong>批次</strong>：在训练神经网络的过程中使用的一组样本。</li>
<li><strong>周期</strong>：完全经过整个训练数据集一轮</li>
<li><strong>前向传播</strong>：根据输入计算输出值</li>
<li><strong>反向传播</strong>：根据优化器算法计算内部变量的调整幅度，从输出层级开始，并往回计算每个层级，直到抵达输入层。</li>
</ul>
<h3 id="练习：摄氏度转化为华氏温度"><a href="#练习：摄氏度转化为华氏温度" class="headerlink" title="练习：摄氏度转化为华氏温度"></a>练习：摄氏度转化为华氏温度</h3><ul>
<li>小结：<a target="_blank" rel="noopener" href="https://classroom.udacity.com/courses/ud187/lessons/e0c70c77-5584-4f83-a47b-a67a6172ae75/concepts/ac6c6991-8096-4c7a-bad1-706f7e3d36f1">https://classroom.udacity.com/courses/ud187/lessons/e0c70c77-5584-4f83-a47b-a67a6172ae75/concepts/ac6c6991-8096-4c7a-bad1-706f7e3d36f1</a></li>
<li>练习讲解：<a target="_blank" rel="noopener" href="https://colab.research.google.com/drive/1vQ9mRFDeeFaP8u1LE6UiYbpF-qBRe5Fb">https://colab.research.google.com/drive/1vQ9mRFDeeFaP8u1LE6UiYbpF-qBRe5Fb</a></li>
<li>个人批注：<a target="_blank" rel="noopener" href="https://github.com/AndreLYL/Tensorflow-learning/blob/master/Tensorflow_Udacity_tutorial_02.ipynb">https://github.com/AndreLYL/Tensorflow-learning/blob/master/Tensorflow_Udacity_tutorial_02.ipynb</a></li>
</ul>
<h3 id="密集层-（Dense-Layer）"><a href="#密集层-（Dense-Layer）" class="headerlink" title="密集层 （Dense Layer）"></a>密集层 （Dense Layer）</h3><p>密集层也叫全连接层，即一个层级的每一个节点都与上一个层级的所有节点相连。</p>
<p><img src="http://ww1.sinaimg.cn/large/006E0Yd9gy1gc72aq6c14j30fw08y0ts.jpg" alt="全连接层"></p>
<p>上图的全连接层在Tensorflow中可以用以下代码实现：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hidden = keras.layers.Dense(units=2, input_shape=[3])</span><br><span class="line">output = keras.layers.Dense(units=1)</span><br><span class="line">model = tf.keras.Sequential([hidden, output])</span><br></pre></td></tr></table></figure>
<p>训练的流程是指讲权重和偏差调整为最佳值，使模型能够将输入和输出相匹配。但训练过程只改变w和b，并不改变模型，即下图中的数学公式。(w: 权重 b: 偏差)<br><img src="http://ww1.sinaimg.cn/large/006E0Yd9gy1gc72isy1r9j30k60acgns.jpg" alt="密集层中的数学运算"></p>
<h2 id="Cha3：-首个模型-Fashion-MNIST"><a href="#Cha3：-首个模型-Fashion-MNIST" class="headerlink" title="Cha3： 首个模型 - Fashion MNIST"></a>Cha3： 首个模型 - Fashion MNIST</h2><h3 id="Sebastian访谈-1"><a href="#Sebastian访谈-1" class="headerlink" title="Sebastian访谈"></a>Sebastian访谈</h3><p>问： 未来十年内，哪些前沿性科技和挑战对深度学习的影响最大？未来最重要的挑战是什么？<br>答： 其一通用人工智能，其二贴合市场</p>
<h3 id="Fashion-MNIST"><a href="#Fashion-MNIST" class="headerlink" title="Fashion MNIST"></a>Fashion MNIST</h3><p>Fashion MNIST是一个数据集,该数据集由28*28像素的灰度服饰图像组成，共70000张图像，下图是其所包含的所有服饰标签的完整列表：<br><img src="http://ww1.sinaimg.cn/large/006E0Yd9gy1gc7353gnruj309808it9x.jpg" alt="Fashion MNIST dataset"></p>
<h3 id="神经网络"><a href="#神经网络" class="headerlink" title="神经网络"></a>神经网络</h3><p><strong>相关术语：</strong></p>
<ul>
<li><strong>扁平化：</strong>将二维图像转换为一维向量的过程</li>
<li><strong>ReLU：</strong>一种激活函数，使模型能够解决非线性问题</li>
<li><strong>Softmax：</strong>一种函数，能够为每个潜在输出类别生成概率</li>
<li><strong>分类：</strong>一种机器学习模型，用于区分两个或多个输出类别</li>
</ul>
<p>** ReLU函数（修正线性单元）**<br>ReLU 是一种激活函数。激活函数有好几种，例如 ReLU、Sigmoid、双曲正切、ELU，但是 ReLU 是最常用的激活函数，通常默认都设为 ReLU。该函数如下图所示，其特性为：如果输入是附属或0，则函数输出为0, 如果输入是正数， 那么输出将等于输入。ReLU使网络能够解决非线性问题，在实际问题中，其大多都为非线性问题。在这种情况下，向密集层添加ReLU有助于解决问题。<a target="_blank" rel="noopener" href="https://www.kaggle.com/dansbecker/rectified-linear-units-relu-in-deep-learning" title="扩展阅读">扩展阅读</a></p>
<p><img src="https://video.udacity-data.com/topher/2019/March/5c7f0cff_tensorflow-l3f1/tensorflow-l3f1.png" alt="ReLU函数"></p>
<p>本章节的神经网络模型如下图所示：<br><img src="http://ww1.sinaimg.cn/large/006E0Yd9gy1gc741v4wkqj30i909ttd4.jpg" alt="该章节神经网络模型"></p>
<p>**Input image:**上面提到，Fashion MNIST数据集中的图像大小均为28 * 28 &#x3D; 784像素，并且神经网络的输入必须是向量，因此需要将图像转化为以为数组，该过程即为扁平化，其实现代码为: <code>tf.keras.layers.Flatten(input_shape=(28,28,1)) </code><br><strong>密集层：</strong>输入将和密集层完全连接，该密集层共128个单元，在这里需要激活函数，其实现代码为：<br><strong>输出层：</strong>输出层共有10个单元，因为该数据集总共有10个类别，在这里每张图片的预测结果应为图像在每个类别中的概率大小，其和为1。（对于任何一个分类神经网络，最后都会添加一个密集层，其包含的单元数量和类别数量一样，并且始终会添加softmax语句）</p>
<h3 id="训练和测试"><a href="#训练和测试" class="headerlink" title="训练和测试"></a>训练和测试</h3><p>数据集通常会划分为不同的子集，如<strong>训练集</strong>和<strong>测试集</strong>，用于训练神经网络和测试神经网络的最终效果。通过测试数据集，我们可以使用网络从未见过的数据测试网络。这样我们便能检测模型的泛化程度，即泛化到训练期间未见过的数据的效果，而不是仅仅记住训练样本。同样，我们通常会使用验证数据集。此类数据集不用于训练，而是在训练期间用于测试模型。我们在一定的训练步数之后使用验证集，判断训练进展如何。例如，如果在训练过程中损失降低了，但是验证集的准确率下降了，则表明模型在记住测试集。训练完毕时，也会使用验证集衡量模型的最终准确率。 扩展阅读：<a target="_blank" rel="noopener" href="https://developers.google.com/machine-learning/crash-course/training-and-test-sets/video-lecture">Google 机器学习速成课程的训练和测试集部分</a><br>当有一个很大的数据集合，一部分用于训练一部分用于测试，测试集的选择需要注意随机化处理，一般训练集越大，训练出的模型越精确，测试集越大，对评估指标的信心越充足，置信区间就越窄。 如果数据集规模比较大，则取其10% ~ 15%就可以得到良好的验证效果，如果数据集比较小，则验证阶段就需要交叉验证等复杂操作。典型陷阱：不要将用于测试的集合同时用于训练，这样会得出非常优秀的结果（如测试准确率100%）。</p>
<h3 id="Code总结"><a href="#Code总结" class="headerlink" title="Code总结"></a>Code总结</h3><ul>
<li><strong>epochs:</strong> epochs的参数对模型的精度有直接的影响，周期数过小，模型欠拟合，精度不够。周期数过大，模型过拟合，在训练集精度很高，在测试集上训练精度很低.</li>
<li><strong>密集层神经元数量：</strong> 神经元过少会明显减小检测的精度，总体上来说，神经元增加会增加会提升精度（根据源码中的练习得出的不完全实验结论）</li>
<li><strong>增加网络层数</strong></li>
<li><strong>玄学：</strong> 官方教程的源码和我的源码的结果差别很大，其一在于同样的参数我的模型最终精度会比课程给的源码的精度低一些。关键我还是按照官方给的代码手打的，而且课程给的参考源码有明显错误，比如模型的输出层没有使用softmax。</li>
<li></li>
</ul>
<p><strong>个人练习：</strong> <a target="_blank" rel="noopener" href="https://colab.research.google.com/drive/1ItgEKIIG55Mc11dpgTQFLMJ-cvMmSnNX#scrollTo=z4Ji8sEmR4YH">https://colab.research.google.com/drive/1ItgEKIIG55Mc11dpgTQFLMJ-cvMmSnNX#scrollTo=z4Ji8sEmR4YH</a><br><strong>课程源码：</strong> <a target="_blank" rel="noopener" href="https://colab.research.google.com/drive/1RV1-alG87M8JWnMU0NaytOGHsieRq9-I#scrollTo=9ODch-OFCaW4">https://colab.research.google.com/drive/1RV1-alG87M8JWnMU0NaytOGHsieRq9-I#scrollTo=9ODch-OFCaW4</a></p>
<h3 id="本章总结"><a href="#本章总结" class="headerlink" title="本章总结"></a>本章总结</h3><p>机器学习的需要解决的问题主要由两个类别：递归问题和分类问题</p>
<ul>
<li><strong>Regression：</strong> 输出一个值的模型。例如，估算房屋价值。</li>
<li><strong>Classfication：</strong> 一种模型，能够输出多个类别的概率分布。例如在 Fashion MNIST 模型中，输出是 10 个概率，每种服饰对应一个概率。我们在最后的密集层中使用 Softmax 激活函数创建了这个概率分布。</li>
</ul>
<p><img src="http://ww1.sinaimg.cn/large/006E0Yd9gy1gc88h1rcnyj30n60bo0vj.jpg" alt="回归和分类的比较">#</p>
<h2 id="Cha4-CNN"><a href="#Cha4-CNN" class="headerlink" title="Cha4: CNN"></a>Cha4: CNN</h2><h3 id="Sebastian访谈-2"><a href="#Sebastian访谈-2" class="headerlink" title="Sebastian访谈"></a>Sebastian访谈</h3><p>问：CNN特点<br>答：具有不变性，结构重复性，CNN的流行不是由于算法的变革，而是大数据<br>问：未来应用领域<br>答：图像，语言领域</p>
<h3 id="CNN简介"><a href="#CNN简介" class="headerlink" title="CNN简介"></a>CNN简介</h3><p>卷积神经网络两个最重要的概念就是卷积(Convolutions)和最大池化(MaxPooling)<br><strong>卷积:</strong> 卷积的运算如下图所示，简单来说就是窗口中的每个pixel的值与卷积核中相应位置的核素相乘，最后将所有的值相加放在居中位置。在这里涉及到边缘像素处理问题，有两种处理方式，其一是将边缘的像素舍弃，但这会造成信息丢失问题；其二是将原图像边缘补0，然后再进行卷积运算。<br><img src="http://ww1.sinaimg.cn/large/006E0Yd9gy1gc8qsvayfjj31ac0oyguz.jpg" alt="卷积运算示例"><br><img src="http://ww1.sinaimg.cn/large/006E0Yd9gy1gc8qym6i5wj30nb0a30x4.jpg" alt="边缘像素处理"><br><strong>最大池化:</strong> 最大池化是指通过总结区域减小输入图像大小的流程，如下图所示，最大池化设计两个主要参数：<strong>网格(pool size)<strong>和</strong>步长(stride)</strong>. 最大池化的过程是找出网格中的pixel最大值并放在新的图像中的相应位置，步长代表窗口的滑动距离，下图中的步长为2。 MaxPooling的过程也叫做下采样。<br><img src="http://ww1.sinaimg.cn/large/006E0Yd9gy1gc8rauhdo0j312u0k548x.jpg" alt="最大池化示例"></p>
<p><strong>小结：</strong> 卷积是指向图像应用滤波器（核）的过程。最大池化是指通过下采样降低图像大小的过程。在 Keras 中使用 Conv2D 层级类型向神经网络模型中添加卷积层。此层级与密集层类似，并且需要将权重和偏差调整为合适的值。Conv2D 层级也有核（滤波器），我们也需要调整这些滤波器的值。在 Conv2D 层级中，我们将调整滤波器矩阵中的值，从而生成正确的输出。</p>
<p><strong>术语：</strong> </p>
<ul>
<li><strong>CNN：</strong> 卷积神经网络。即至少有一个卷积层的网络。典型的 CNN 还包括其他类型的层级，例如池化层和密集层。</li>
<li><strong>卷积：</strong> 向图像应用核（滤波器）的过程</li>
<li><strong>核&#x2F;滤波器：</strong> 小于输入的矩阵，用于将输入变成多个小区域</li>
<li><strong>填充：</strong> 在输入图像周围添加像素，像素值通常为 0</li>
<li><strong>池化：</strong> 通过下采样降低图像大小的过程。池化层有多种类型。例如，平均池化通过求平均值将多个值变成一个值。但是最大池化是最常见的池化类型。</li>
<li><strong>最大池化：</strong> 一种池化过程，通过获取多个值中的最大值，将多个值变成一个值。</li>
<li><strong>步长：</strong> 在图像上滑动核（滤波器）的间隔像素数量。</li>
<li><strong>下采样：</strong> 降低图像大小的操作</li>
</ul>
<p>扩展阅读：<a target="_blank" rel="noopener" href="https://towardsdatascience.com/a-comprehensive-guide-to-convolutional-neural-networks-the-eli5-way-3bd2b1164a53">卷积神经网络综合指南</a></p>
<h2 id="cha5-CNN深度学习"><a href="#cha5-CNN深度学习" class="headerlink" title="cha5 CNN深度学习"></a>cha5 CNN深度学习</h2><h3 id="Sebastian访谈-3"><a href="#Sebastian访谈-3" class="headerlink" title="Sebastian访谈"></a>Sebastian访谈</h3><p>过拟合是由偏差方差权值(bias-variance trade-off)导致的,相对于数据来说，参数越多，越有可能选择完全随机的解，而不是一个好的解。有两种方法可以解决过拟合问题，第一种方法是拆分数据集，如90%的数据作为训练集，10%的数据作为测试集，然后执行交叉验证(cross validation)，即使训练时没用到测试集检查模型性能，如果损失上升，则停止训练。第二种方法是约束网络。例如可以使权重加上偏差，假设使所有权重尽可能接近零，对这些权重的约束越强，越不可能过拟合。此外还可以设置测试集，训练集和验证集，这里还有一个问题，如果在测试集上测试了很多次，最终结果将过拟合测试集。</p>
<h3 id="猫狗分类"><a href="#猫狗分类" class="headerlink" title="猫狗分类"></a>猫狗分类</h3><p>CNN网络不仅可以处理灰度图像，还可以处理彩色图像。 在这里将采用CNN结构训练一个可以识别猫狗的模型，所采用的数据集是微软Asirra猫狗数据集。数据集中的图片有两种标签：0代表cat, 1代表dog。该数据集中的图片尺寸各不相同，因但神经网路要求的输入尺寸是固定的，此需要进行预处理。tf.keras.layers.Flatten(input_shape&#x3D;(28, 28, 1))函数在图像尺寸大小不同时，扁平化生成的以为数组的大小也不同，因此需要先将尺寸统一，再进行扁平化操作。<br><strong>彩色图像处理</strong><br>计算机会将彩色图像解析为三维数组，如下图所示：<br><img src="http://ww1.sinaimg.cn/large/006E0Yd9gy1gcmmofhwz5j31bb0pd7lu.jpg" alt="彩色图像表达"><br>对RGB图像执行卷积运算即分别对R, G, B, 三个通道进行卷积操作，在计算出每个通道的结果后将其相加，再加上一个偏差值1，放入卷积输出中去。<br><img src="http://ww1.sinaimg.cn/large/006E0Yd9gy1gcmmydcxsjj31ah0pgkgx.jpg" alt="彩色图像卷积输出"><br>在实际使用CNN的时候，通常会采用多个三维过滤器，最后得出多个卷积输出结果。卷积输出的深度由卷积核的数量来决定。注意，在训练CNN时，我们将更新三维核中的值从而最小化损失函数。<br><img src="http://ww1.sinaimg.cn/large/006E0Yd9gy1gcmn1rg96hj30ok0cdafr.jpg" alt="多个卷积核"></p>
<p><strong>最大池化</strong><br>在三维卷积输出的结果上执行最大池化运算的方法和灰度图像的运算方式相同。<br><img src="http://ww1.sinaimg.cn/large/006E0Yd9gy1gcmn8lynasj30nb0do42y.jpg" alt="彩色图像最大池化"></p>
<h2 id="colab键盘快捷键"><a href="#colab键盘快捷键" class="headerlink" title="colab键盘快捷键"></a>colab键盘快捷键</h2><ul>
<li><p><strong>⌘&#x2F;Ctrl+m,b：</strong>在当前选择的单元格下方创建一个空白代码单元格</p>
</li>
<li><p><strong>⌘&#x2F;Ctrl+m,i：</strong>中断单元格的运行</p>
</li>
<li><p><strong>⌘&#x2F;Ctrl+m,h：</strong>显示所有键盘快捷键列表</p>
</li>
<li><p><strong>⌘&#x2F;Shift+Enter：</strong>执行当前单元格并自动新建下一个的单元格</p>
</li>
<li><p>要查看关于任何 TensorFlow API 方法的文档，请将光标放置在其左括号的正后方，然后按 <strong>Tab</strong> 键：</p>
<p><img src="https://download.mlcc.google.cn/mledu-images/tf_pop_up_doc_example.png" alt="TensorFlow tf.constant 方法的弹出式文档"></p>
</li>
</ul>
<p><strong>Softmax 与 S 型函数</strong><br>在上个 Colab 中，我们使用了以下 CNN 结构：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">model = tf.keras.models.Sequential([</span><br><span class="line">    tf.keras.layers.Conv2D(32, (3,3), activation=&#x27;relu&#x27;, input_shape=(150, 150, 3)),</span><br><span class="line">    tf.keras.layers.MaxPooling2D(2, 2),</span><br><span class="line"></span><br><span class="line">    tf.keras.layers.Conv2D(64, (3,3), activation=&#x27;relu&#x27;),</span><br><span class="line">    tf.keras.layers.MaxPooling2D(2,2),</span><br><span class="line"></span><br><span class="line">    tf.keras.layers.Conv2D(128, (3,3), activation=&#x27;relu&#x27;),</span><br><span class="line">    tf.keras.layers.MaxPooling2D(2,2),</span><br><span class="line"></span><br><span class="line">    tf.keras.layers.Conv2D(128, (3,3), activation=&#x27;relu&#x27;),</span><br><span class="line">    tf.keras.layers.MaxPooling2D(2,2),</span><br><span class="line"></span><br><span class="line">    tf.keras.layers.Flatten(),</span><br><span class="line">    tf.keras.layers.Dense(512, activation=&#x27;relu&#x27;),</span><br><span class="line">    tf.keras.layers.Dense(2, activation=&#x27;softmax&#x27;)</span><br><span class="line">])</span><br></pre></td></tr></table></figure>
<p>注意，最后一个层级（分类器）由一个 Dense 层（具有 2 个输出单元）和一个 softmax 激活函数组成，如下所示：<br><code> tf.keras.layers.Dense(2, activation=&#39;softmax&#39;)</code><br>在处理二元分类问题时，另一个常见方法是：分类器由一个 Dense 层（具有 1 个输出单元）和一个 sigmoid 激活函数组成，如下所示：<br><code>tf.keras.layers.Dense(1, activation=&#39;sigmoid&#39;)</code><br>这两种方法都适合二元分类问题，但是请注意，如果决定在分类器中使用 sigmoid 激活函数，需要将 model.compile() 方法中的 loss 参数从 ‘sparse_categorical_crossentropy’ 更改为’binary_crossentropy’，如下所示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">model.compile(optimizer=&#x27;adam&#x27;, </span><br><span class="line">              loss=&#x27;binary_crossentropy&#x27;,</span><br><span class="line">              metrics=[&#x27;accuracy&#x27;])</span><br></pre></td></tr></table></figure>

<h2 id="General-machine-learning-workflow"><a href="#General-machine-learning-workflow" class="headerlink" title="General machine learning workflow"></a>General machine learning workflow</h2><ol>
<li>Examine and understand data</li>
<li>Build an input pipeline</li>
<li>Build our model</li>
<li>Train our model</li>
<li>Test our model</li>
<li>Improve our model&#x2F;Repeat the process</li>
</ol>
</div></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="Your name"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Your name</p><p class="is-size-6 is-block">Your title</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Your location</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">32</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">3</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">15</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/ppoffice" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/ppoffice"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/%E6%85%8E%E6%80%9D/"><span class="level-start"><span class="level-item">慎思</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%9C%AF%E4%B8%9A/"><span class="level-start"><span class="level-item">术业</span></span><span class="level-end"><span class="level-item tag">26</span></span></a></li><li><a class="level is-mobile" href="/categories/%E7%8E%A9%E7%89%A9/"><span class="level-start"><span class="level-item">玩物</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><figure class="media-left"><a class="image" href="/2022/03/04/Notebook/Linux/Linux_Bash/"><img src="http://ww1.sinaimg.cn/large/006E0Yd9gy1gay01tguhxj30go07s3yj.jpg" alt="Linux Bash总结"></a></figure><div class="media-content"><p class="date"><time dateTime="2022-03-03T16:00:00.000Z">2022-03-04</time></p><p class="title"><a href="/2022/03/04/Notebook/Linux/Linux_Bash/">Linux Bash总结</a></p><p class="categories"><a href="/categories/%E6%9C%AF%E4%B8%9A/">术业</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2021/05/09/work/005.FreeRTOS/"><img src="http://ww1.sinaimg.cn/large/006E0Yd9gy1gaeafbwql6j30sg0g0aa5.jpg" alt="FreeRTOS学习笔记02"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-05-08T16:00:00.000Z">2021-05-09</time></p><p class="title"><a href="/2021/05/09/work/005.FreeRTOS/">FreeRTOS学习笔记02</a></p><p class="categories"><a href="/categories/%E6%9C%AF%E4%B8%9A/">术业</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2021/05/07/work/004.RTOS/"><img src="http://ww1.sinaimg.cn/large/006E0Yd9gy1gaeafbwql6j30sg0g0aa5.jpg" alt="FreeRTOS学习笔记01"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-05-06T16:00:00.000Z">2021-05-07</time></p><p class="title"><a href="/2021/05/07/work/004.RTOS/">FreeRTOS学习笔记01</a></p><p class="categories"><a href="/categories/%E6%9C%AF%E4%B8%9A/">术业</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2021/05/03/work/Emmbed_system_QA/"><img src="http://ww1.sinaimg.cn/large/006E0Yd9gy1gaeafbwql6j30sg0g0aa5.jpg" alt="嵌入式面试常见问题整理"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-05-02T16:00:00.000Z">2021-05-03</time></p><p class="title"><a href="/2021/05/03/work/Emmbed_system_QA/">嵌入式面试常见问题整理</a></p><p class="categories"><a href="/categories/%E6%9C%AF%E4%B8%9A/">术业</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-04-30T16:00:00.000Z">2021-05-01</time></p><p class="title"><a href="/2021/05/01/work/001.c_basic/">C语言基础-嵌入式面试</a></p><p class="categories"><a href="/categories/%E6%9C%AF%E4%B8%9A/">术业</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2022/03/"><span class="level-start"><span class="level-item">三月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/05/"><span class="level-start"><span class="level-item">五月 2021</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/02/"><span class="level-start"><span class="level-item">二月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/01/"><span class="level-start"><span class="level-item">一月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/05/"><span class="level-start"><span class="level-item">五月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/04/"><span class="level-start"><span class="level-item">四月 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/03/"><span class="level-start"><span class="level-item">三月 2020</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/02/"><span class="level-start"><span class="level-item">二月 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/01/"><span class="level-start"><span class="level-item">一月 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/12/"><span class="level-start"><span class="level-item">十二月 2019</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/05/"><span class="level-start"><span class="level-item">五月 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/03/"><span class="level-start"><span class="level-item">三月 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/02/"><span class="level-start"><span class="level-item">二月 2019</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Apollo/"><span class="tag">Apollo</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Blogs/"><span class="tag">Blogs</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/C/"><span class="tag">C++</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CV/"><span class="tag">CV</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Self-driving/"><span class="tag">Self-driving</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Tensorflow/"><span class="tag">Tensorflow</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nvidia/"><span class="tag">nvidia</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/object-detection/"><span class="tag">object detection</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/photo/"><span class="tag">photo</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/point-cloud/"><span class="tag">point cloud</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pytorch/"><span class="tag">pytorch</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%B5%8C%E5%85%A5%E5%BC%8F/"><span class="tag">嵌入式</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%BB%BA%E6%A8%A1/"><span class="tag">建模</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%BE%B7%E5%9B%BD%E9%A9%BE%E7%85%A7/"><span class="tag">德国驾照</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%88%AA%E6%8B%8D/"><span class="tag">航拍</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div></div><div class="column column-right is-4-tablet is-4-desktop is-4-widescreen  order-3"><!--!--></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="Hexo" height="28"></a><p class="is-size-7"><span>&copy; 2022 John Doe</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>